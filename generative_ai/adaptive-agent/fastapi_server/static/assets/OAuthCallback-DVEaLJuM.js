import{u as h,a as E,b as g,r as p,c as m,d as y,o as x,P as S,j as b}from"./index-NYxXJ4c7.js";const v=()=>{const r=h(),n=E(),i=g(),c=(t,o)=>{const e=new URLSearchParams;return e.set("error",t),o&&e.set("error_message",o),`${S.SETTINGS.SOURCES}?${e.toString()}`},u=new URLSearchParams(n.search),a=u.get("error");p.useEffect(()=>{a&&r(c(a),{replace:!0})},[a,r]);const d=u.get("state"),{isSuccess:l,isError:f,error:s}=m(n.search,!!d&&!a);return p.useEffect(()=>{if(l&&(i.invalidateQueries({queryKey:y.currentUser}),i.invalidateQueries({queryKey:x.all}),r(S.SETTINGS.SOURCES,{replace:!0})),f){let t="OAuth connection failed";if(s&&typeof s=="object"&&"response"in s){const e=s.response?.data?.detail;e&&typeof e=="object"&&e!==null&&"message"in e?t=String(e.message):typeof e=="string"&&(t=e)}r(c("oauth_failed",t),{replace:!0})}},[l,f,r,i,s]),b.jsx("div",{className:"flex items-center justify-center h-full",children:"Finishing sign-inâ€¦"})};export{v as default};
